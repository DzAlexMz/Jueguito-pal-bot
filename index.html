<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Voleibol de Playa</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1a1a1a;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }

        .game-container {
            position: relative;
            width: 800px;
            height: 500px;
            background: url('/api/placeholder/800/500') center/cover;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .sand {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to top, #f4d03f, #f5d76e);
            opacity: 0.9;
        }

        .net {
            position: absolute;
            left: 395px;
            bottom: 0;
            width: 10px;
            height: 150px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        .ball {
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.05s;
        }

        .player {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #3498db;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            transition: all 0.1s;
        }

        .bot {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #e74c3c;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            transition: all 0.1s;
        }

        .score {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 20px;
            border-radius: 10px;
            transition: transform 0.2s;
        }

        .score:hover {
            transform: translateX(-50%) scale(1.1);
        }

        .start-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 15px 30px;
            font-size: 20px;
            font-weight: bold;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .start-button:hover {
            background: #2980b9;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .instructions {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            transition: transform 0.2s;
        }

        .instructions:hover {
            transform: translateX(-50%) scale(1.1);
        }
    </style>
</head>
<body>
    <div id="game"></div>

    <script type="text/javascript">
        const Game = () => {
            const [gameState, setGameState] = React.useState({
                ball: { x: 400, y: 200, dx: 0, dy: 0 },
                player: { x: 150, y: 400 },
                bot: { x: 650, y: 400 },
                playerScore: 0,
                botScore: 0,
                gameStarted: false,
                lastHit: null
            });

            const [keys, setKeys] = React.useState({
                ArrowLeft: false,
                ArrowRight: false
            });

            const audioContext = React.useMemo(() => new (window.AudioContext || window.webkitAudioContext)(), []);

            const createSound = React.useCallback((type) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                switch(type) {
                    case 'hit':
                        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        oscillator.type = 'sine';
                        break;
                    case 'score':
                        oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        oscillator.type = 'square';
                        break;
                    case 'bounce':
                        oscillator.frequency.setValueAtTime(100, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        oscillator.type = 'triangle';
                        break;
                }

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.start();
                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + 0.1);
                oscillator.stop(audioContext.currentTime + 0.1);
            }, [audioContext]);

            // Constantes del juego
            const GRAVITY = 0.5;
            const MOVE_SPEED = 5;
            const BALL_SPEED = 8;
            const PLAYER_WIDTH = 40;
            const PLAYER_HEIGHT = 60;
            const BALL_SIZE = 20;

            React.useEffect(() => {
                const handleKeyDown = (e) => {
                    if (Object.keys(keys).includes(e.key)) {
                        setKeys(prev => ({ ...prev, [e.key]: true }));
                    }
                };

                const handleKeyUp = (e) => {
                    if (Object.keys(keys).includes(e.key)) {
                        setKeys(prev => ({ ...prev, [e.key]: false }));
                    }
                };

                window.addEventListener('keydown', handleKeyDown);
                window.addEventListener('keyup', handleKeyUp);

                return () => {
                    window.removeEventListener('keydown', handleKeyDown);
                    window.removeEventListener('keyup', handleKeyUp);
                };
            }, []);

            React.useEffect(() => {
                if (!gameState.gameStarted) return;

                const gameLoop = setInterval(() => {
                    setGameState(prev => {
                        let newState = { ...prev };

                        // Movimiento del jugador
                        if (keys.ArrowLeft && prev.player.x > 0) {
                            newState.player.x -= MOVE_SPEED;
                        }
                        if (keys.ArrowRight && prev.player.x < 380) {
                            newState.player.x += MOVE_SPEED;
                        }

                        // Movimiento del bot
                        const botTarget = prev.ball.x > 400 ? prev.ball.x : 650;
                        newState.bot.x += (botTarget - prev.bot.x) * 0.05;
                        newState.bot.x = Math.max(420, Math.min(760, newState.bot.x));

                        // Física de la pelota
                        newState.ball.x += prev.ball.dx;
                        newState.ball.y += prev.ball.dy;
                        newState.ball.dy += GRAVITY;

                        // Rebote en el suelo
                        if (newState.ball.y > 480) {
                            createSound('bounce');
                            if (newState.ball.x < 400) {
                                newState.botScore += 1;
                                createSound('score');
                            } else {
                                newState.playerScore += 1;
                                createSound('score');
                            }
                            newState.ball = { 
                                x: 400, 
                                y: 200, 
                                dx: Math.random() * 8 - 4, 
                                dy: -BALL_SPEED 
                            };
                        }

                        // Rebotes y colisiones
                        if (newState.ball.x < 0 || newState.ball.x > 800) {
                            newState.ball.dx *= -1;
                            createSound('bounce');
                        }

                        const checkPlayerCollision = (playerX, playerY, isPlayer) => {
                            const dx = newState.ball.x - playerX;
                            const dy = newState.ball.y - playerY;
                            const distance = Math.sqrt(dx * dx + dy * dy);

                            if (distance < PLAYER_WIDTH && newState.lastHit !== isPlayer) {
                                const angle = Math.atan2(dy, dx);
                                newState.ball.dx = Math.cos(angle) * BALL_SPEED;
                                newState.ball.dy = Math.sin(angle) * BALL_SPEED - 2;
                                newState.lastHit = isPlayer;
                                createSound('hit');
                            }
                        };

                        checkPlayerCollision(prev.player.x, prev.player.y, 'player');
                        checkPlayerCollision(prev.bot.x, prev.bot.y, 'bot');

                        return newState;
                    });
                }, 1000/60);

                return () => clearInterval(gameLoop);
            }, [gameState.gameStarted, keys, createSound]);

            return (
                <div className="game-container">
                    <div className="sand"></div>
                    <div className="net"></div>
                    <div 
                        className="ball"
                        style={{
                            left: gameState.ball.x - BALL_SIZE/2,
                            top: gameState.ball.y - BALL_SIZE/2,
                            transform: `rotate(${gameState.ball.dx * 10}deg)`
                        }}
                    ></div>
                    <div 
                        className="player"
                        style={{
                            left: gameState.player.x - PLAYER_WIDTH/2,
                            top: gameState.player.y - PLAYER_HEIGHT/2
                        }}
                    ></div>
                    <div 
                        className="bot"
                        style={{
                            left: gameState.bot.x - PLAYER_WIDTH/2,
                            top: gameState.bot.y - PLAYER_HEIGHT/2
                        }}
                    ></div>
                    <div className="score">
                        {gameState.playerScore} - {gameState.botScore}
                    </div>
                    {!gameState.gameStarted && (
                        <button 
                            className="start-button"
                            onClick={() => {
                                audioContext.resume();
                                setGameState(prev => ({ ...prev, gameStarted: true }));
                            }}
                        >
                            ¡Empezar Juego!
                        </button>
                    )}
                    <div className="instructions">
                        Usa las flechas ← → para moverte
                    </div>
                </div>
            );
        };

        ReactDOM.render(
            React.createElement(Game),
            document.getElementById('game')
        );
    </script>
</body>
</html>
